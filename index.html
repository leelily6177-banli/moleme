<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>摸了吗</title>
    <style>
        :root {
            --bg-color: #f4f1ea;
            --card-bg: #ffffff;
            --text-main: #5a5a5a;
            --accent-green: #9fac96;
            --accent-blue: #a1b0bc;
            --accent-rose: #c29d91;
            --border-color: #e0ddd5;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body {
            background-color: var(--bg-color);
            color: var(--text-main);
            font-family: "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .app-container {
            width: 95%;
            max-width: 420px;
            background: var(--card-bg);
            border-radius: 24px;
            padding: 25px 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.05);
            border: 1px solid var(--border-color);
            position: relative;
        }

        /* 段位勋章样式 */
        .rank-badge {
            position: absolute;
            top: -15px;
            right: 20px;
            background: var(--accent-rose);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: bold;
            box-shadow: 0 4px 10px rgba(194, 157, 145, 0.4);
        }

        header { text-align: center; margin-bottom: 20px; }
        h1 { font-size: 26px; color: var(--accent-green); letter-spacing: 4px; font-weight: 500; }
        .subtitle { font-size: 12px; color: #b5b1a8; margin-top: 5px; }

        .form-group { margin-bottom: 15px; }
        label { display: block; font-size: 12px; color: #888; margin-bottom: 5px; font-weight: 500;}
        input {
            width: 100%;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            background-color: #faf9f6;
            color: var(--text-main);
            outline: none;
            font-size: 16px;
        }

        .category-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 20px;
        }
        .cat-item {
            padding: 10px 5px;
            border: 1px solid var(--border-color);
            border-radius: 10px;
            text-align: center;
            font-size: 12px;
            cursor: pointer;
            background: #fff;
            color: #888;
        }
        .cat-item.active {
            background-color: var(--accent-blue);
            color: white;
            border-color: var(--accent-blue);
        }
        /* 自定义输入项样式 */
        .custom-item { border-style: dashed; border-width: 2px; }

        .btn-start {
            width: 100%;
            padding: 15px;
            background-color: var(--accent-green);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }

        #running-zone { display: none; text-align: center; }
        .money-display {
            font-size: 44px;
            font-weight: 300;
            color: var(--text-main);
            margin: 15px 0;
            font-family: "Georgia", serif;
        }
        .timer-info {
            display: flex; justify-content: space-around;
            margin-bottom: 25px; font-size: 13px; color: #999;
        }

        .action-btns { display: flex; gap: 10px; }
        .btn-secondary {
            flex: 1; padding: 12px; border-radius: 10px;
            border: 1px solid var(--border-color);
            background: #fff; color: #888; cursor: pointer;
        }
        .btn-boss { background-color: var(--accent-rose); color: white; border: none; font-weight: 600; }

        #boss-mask {
            display: none; position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            background: #fff; z-index: 9999; padding: 30px;
            overflow-y: auto; color: #333;
        }
    </style>
</head>
<body>

    <div class="app-container">
        <!-- 段位勋章 -->
        <div class="rank-badge" id="rank-display">摸鱼新兵</div>

        <div id="setup-zone">
            <header>
                <h1>摸了吗</h1>
                <p class="subtitle">让摸鱼的每一秒都有价值</p>
            </header>

            <div class="form-group">
                <label>参考月薪 (RMB)</label>
                <input type="number" id="salary" value="12000">
            </div>

            <label>摸鱼项目</label>
            <div class="category-grid" id="cat-grid">
                <div class="cat-item active" onclick="selectCat(this)">带薪如厕</div>
                <div class="cat-item" onclick="selectCat(this)">工位神游</div>
                <div class="cat-item" onclick="selectCat(this)">饮水工程</div>
                <div class="cat-item" onclick="selectCat(this)">系统更新</div>
                <div class="cat-item" onclick="selectCat(this)">研读文档</div>
                <div class="cat-item custom-item" id="custom-trigger" onclick="handleCustom()">+ 自定义</div>
            </div>

            <button class="btn-start" onclick="start()">开启收益模式</button>
            <p style="font-size: 10px; color: #ccc; text-align: center; margin-top: 15px;">累计摸鱼: <span id="total-time-display">0</span> 分钟</p>
        </div>

        <div id="running-zone">
            <div id="current-task" style="color: var(--accent-green); font-size: 14px; font-weight: 500;">正在进行：带薪如厕</div>
            <div class="money-display" id="money-val">￥0.0000</div>
            <div class="timer-info">
                <div>时长: <span id="time-val">00:00:00</span></div>
                <div>时薪: <span id="rate-val">0.00</span>元</div>
            </div>
            <div class="action-btns">
                <button class="btn-secondary btn-boss" onclick="toggleBoss()">老板来了</button>
                <button class="btn-secondary" onclick="stop()">结算下班</button>
            </div>
        </div>
    </div>

    <div id="boss-mask" onclick="toggleBoss()">
        <div id="boss-content-area" style="max-width: 800px; margin: 0 auto; text-align: left;"></div>
    </div>

    <script>
        let timer, startTime, secondRate, activeCat = "带薪如厕";
        let totalSeconds = parseInt(localStorage.getItem('mulema_total_seconds')) || 0;

        const dasKapitalQuotes = [
            "资本是死劳动，它像吸血鬼一样，只有吮吸活劳动才有生命。",
            "时间是人类发展的空间。一个人如果没有自由的时间，他连牛马都不如。",
            "工作日不仅有生理界限，而且有道德界限。",
            "工人不仅在劳动时生产他人的价值，而且他在不劳动时也为他人生产价值。",
            "在资本主义制度内部，一切提高生产力的方法都是靠牺牲工人个人来实现的。"
        ];

        // 初始化显示
        updateRankDisplay();

        function updateRankDisplay() {
            const mins = Math.floor(totalSeconds / 60);
            const hours = totalSeconds / 3600;
            document.getElementById('total-time-display').innerText = mins;
            
            let rank = "摸鱼新兵";
            if(hours >= 100) rank = "摸鱼之神";
            else if(hours >= 20) rank = "深海巨鲨";
            else if(hours >= 5) rank = "划水大师";
            else if(hours >= 1) rank = "老练咸鱼";
            
            document.getElementById('rank-display').innerText = rank;
        }

        function handleCustom() {
            const userTask = prompt("请输入你的奇葩摸鱼项目：", "发呆思考人生");
            if (userTask) {
                const trigger = document.getElementById('custom-trigger');
                trigger.innerText = userTask;
                selectCat(trigger);
            }
        }

        function selectCat(el) {
            document.querySelectorAll('.cat-item').forEach(item => item.classList.remove('active'));
            el.classList.add('active');
            activeCat = el.innerText;
        }

        function start() {
            const salary = document.getElementById('salary').value;
            if(!salary) return alert("请输入月薪");
            secondRate = salary / 21.75 / 8 / 3600;
            document.getElementById('rate-val').innerText = (secondRate * 3600).toFixed(2);
            document.getElementById('current-task').innerText = "正在进行：" + activeCat;
            document.getElementById('setup-zone').style.display = 'none';
            document.getElementById('running-zone').style.display = 'block';
            startTime = new Date();
            timer = setInterval(tick, 100);
        }

        function tick() {
            const elapsed = (new Date() - startTime) / 1000;
            document.getElementById('money-val').innerText = "￥" + (elapsed * secondRate).toFixed(4);
            const h = Math.floor(elapsed / 3600).toString().padStart(2, '0');
            const m = Math.floor((elapsed % 3600) / 60).toString().padStart(2, '0');
            const s = Math.floor(elapsed % 60).toString().padStart(2, '0');
            document.getElementById('time-val').innerText = `${h}:${m}:${s}`;
        }

        function stop() {
            clearInterval(timer);
            const elapsedSeconds = Math.floor((new Date() - startTime) / 1000);
            
            // 更新累计时间并保存
            totalSeconds += elapsedSeconds;
            localStorage.setItem('mulema_total_seconds', totalSeconds);
            
            const totalMoney = document.getElementById('money-val').innerText;
            const quote = dasKapitalQuotes[Math.floor(Math.random() * dasKapitalQuotes.length)];
            
            alert(
                "结算成功！\n" +
                "您刚才在【" + activeCat + "】期间，成功夺回了 " + totalMoney + " 的剩余价值。\n\n" +
                "LQ提醒你：\n“" + quote + "”"
            );
            location.reload();
        }

        function toggleBoss() {
            const mask = document.getElementById('boss-mask');
            const area = document.getElementById('boss-content-area');
            if (mask.style.display === 'block') {
                mask.style.display = 'none';
            } else {
                area.innerHTML = `<h2 style="margin-bottom:20px;">Q1 季度审计报告</h2><p>基于当前宏观环境，我们需持续优化链路成本...</p>`;
                mask.style.display = 'block';
            }
        }
    </script>
</body>
</html>
